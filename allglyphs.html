<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="last-modified" content="2018-05-12" />
    <title>morphclock: glyphs</title>
    <link rel="stylesheet" type="text/css" href="morph.css">
    <script type="text/javascript" language="javascript" src="morphclock.min.js"></script>
  </head>
  <body>
    <svg style="position:absolute; width:0; height:0">
      <defs>
        <linearGradient id="Gradient-1" x1="0" y1="0" x2="0" y2="100%" gradientUnits="userSpaceOnUse">
          <stop offset="0%" stop-color="red" />
          <stop offset="100%" stop-color="blue" />
        </linearGradient>
      </defs>
    </svg>
    <h1>morphclock: glyphs</h1>
      <h2>Die statischen Glyphen</h2>
        <div id="standalone" style="stroke: black;"></div>
      <h2>Die Übergänge</h2>
        <div id="transition" style="stroke: black;"></div>
      <h2>Die Uhr</h2>
        <div id="clock" style="stroke: black;"></div>

        <script type="text/javascript" language="javascript">
          /* Einfache Beispiele:
             Wir verteilen die gesamten Pfade auf die drei Bereiche
             standalone, transition und clock:
          */
          const standalone = {};
          const transition = {};
          const clock = {};
          const exampleWidth = "12.5%";

          for (let key of Object.keys(Morph.path)) {
            if (key.length == 1) standalone[key] = Morph.path[key];
            else if (key.slice(4) == "clock") clock[key] = Morph.path[key];
            else if (key.slice(-2) == "-0") transition[key] = Morph.path[key];
          }

          // die standalone-Glyphen
          const skeys = Object.keys(standalone).sort();
          const sglyphs = [];
          const sdiv = document.getElementById('standalone');

          for (let key of skeys) {
            sglyphs.push(new MorphGlyph(key, sdiv, exampleWidth));
          }

          // die transition-Glyphen
          var tkeys = Object.keys(transition).sort();
          const tglyphs = [];
          const tdiv = document.getElementById('transition');

          for (let key of tkeys) {
            var tglyph = new MorphGlyph(key, tdiv, exampleWidth);
            tglyphs.push(tglyph);
          }

          // die Uhr
          const cdiv = document.getElementById('clock');
          const cglyph = new MorphGlyph('clock-0', cdiv, exampleWidth);
          // wir stellen die Uhr auf die aktuelle Zeit:
          let currentTime = new Date;
          let h = currentTime.getHours();
          let m = currentTime.getMinutes();
          let s = currentTime.getSeconds();
          let clockstart = (h * 60 + m) % 720;
          let startmin = m;
          let startsec = s;

          cglyph.type = cglyph.prefix + clockstart;

          function renderTime() {
            currentTime = new Date();
            m = currentTime.getMinutes();
            s = currentTime.getSeconds();
            t = currentTime.getMilliseconds();

            var morph = 0;

            setTimeout('renderTime()',10);

            tglyphs.forEach(g => {
              if (s % 3 == 0) morph = "0";
              else if (s % 3 == 1) {
                // quickmorph-Definition
                morph = Math.floor(t/10);
              }
              else morph = "99";
              g.type = g.prefix + morph;
            });

            // die Uhr läuft 60× schneller als gewöhnlich
            let offset = ((m - startmin) * 60 + (s - startsec));
            morph = (offset + clockstart) % 720;
            cglyph.type = cglyph.prefix + morph;
          }
          renderTime();
        </script>
  </body>
</html>
